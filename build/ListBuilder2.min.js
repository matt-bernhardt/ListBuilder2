/*! ListBuilder2 2014-05-06 */
window.app=window.app||{},window.app.listbuilder={initialize:function(a){a=a||{},this.list=a.listElement||$(".listbuilder"),window.console||(console={log:function(){}}),this.debugFlag=a.debugFlag||!0,this.debug("init called"),listcontainer=document.createElement("div"),original=this.list,$(listcontainer).attr("class","listcontainer"),$(this.list).after(listcontainer),unselected=document.createElement("div"),$(unselected).attr("class","unselected bucket"),$(unselected).attr("data-bucket","unselected"),$(unselected).append("<div class='label'><label for='listfilter'>Search:</label><input type='text' name='listfilter' id='listfilter'><a class='reset'>Clear</a></div>"),$(listcontainer).append(unselected),selected=document.createElement("div"),$(selected).attr("class","selected bucket"),$(selected).attr("data-bucket","selected"),$(selected).append("<div class='label'>Show:</div>"),$(listcontainer).append(selected),this.populateList(),$(this.list).addClass("listhidden"),this.debug("init finished")},getClick:function(a){this.debug("click "+a.attr("data-value")),from=a.parent().attr("data-bucket"),this.debug("from "+from),to="unselected"==from?"selected":"unselected",$(listcontainer).children("div[data-bucket='"+to+"']").append(a),this.syncSelect(),this.sortList(selected),this.sortList(unselected)},getFilter:function(a){a=a.toLowerCase(),$(unselected).children(".option").each(function(){$(this).removeClass("hidden"),theValue=$(this).attr("data-value").toLowerCase(),-1==theValue.indexOf(a)&&$(this).addClass("hidden")})},populateList:function(){this.debug("syncing..."),$(this.list).children("option").each(function(a,b){option=document.createElement("div"),$(option).attr("class","option"),$(option).attr("data-value",b.value),$(option).append(b.text),b.selected===!1?$(unselected).append(option):$(selected).append(option)}),this.debug("sync finished")},resetFilter:function(){$("#listfilter").val(""),this.getFilter("")},sortList:function(a){this.debug("sorting list");var b=$(a).children("div.option").get();b.sort(function(a,b){var c=$(a).text(),d=$(b).text();return d>c?-1:c>d?1:0});var c=$(a);$.each(b,function(a,b){c.append(b)}),this.debug("list sorted")},syncSelect:function(){this.debug("syncing select"),$(this.list).children("option").prop("selected",!1),$(selected).children(".option").each(function(){$(original).find("option[value='"+$(this).attr("data-value")+"']").prop("selected",!0)}),this.debug("select updated")},debug:function(a){this.debugFlag&&console.log(a)}};